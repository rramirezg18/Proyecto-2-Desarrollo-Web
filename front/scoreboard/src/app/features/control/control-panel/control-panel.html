<div class="cp-toolbar">
  <div class="left">
    <button mat-stroked-button (click)="goScoreboard()">‚¨ÖÔ∏è Ir al marcador</button>

    <!-- Solo ADMIN -->
    <button mat-raised-button color="primary" *ngIf="isAdmin" (click)="newGameFromRegistered()">‚ûï Nuevo partido</button>
    <button mat-raised-button color="primary" *ngIf="isAdmin" (click)="newGameFromRegistered()">üß© Nuevo (equipos)</button>
    <button mat-raised-button color="accent"  *ngIf="isAdmin" (click)="registerTeam()">üìù Registrar equipo</button>

    <!-- Para ambos roles -->
    <button mat-stroked-button color="accent" (click)="showStandings()">üèÜ Standings</button>

    <!-- Elegir partido -->
    <button mat-stroked-button color="primary" (click)="openPickMatch()">üéÆ Elegir partido</button>
  </div>

  <div class="right">
    <button mat-raised-button color="warn" (click)="logout()">üîí Logout</button>
  </div>
</div>

<div class="cp">
  <!-- Toolbar superior gris -->
  <div class="toolbar">
    <button class="btn" (click)="registerTeam()">Register Team</button>
    <button class="btn" (click)="newGameFromRegistered()">New Game (Teams)</button>
    <button class="btn" (click)="showStandings()">Standings</button>
    <button class="btn" (click)="rt.beep()">Buzzer</button>

    <button class="btn" (click)="openPickMatch()">Elegir partido</button>
  </div>

  <!-- Centro: controles de tiempo -->
  <div class="time-center">
    <div class="status" [class.paused]="!rt.timerRunning()" [class.dark]="!rt.timerRunning()">
      {{ rt.timerRunning() ? 'Running' : 'Paused' }}
    </div>

    <div class="clock">{{ clock() }}</div>
    <div class="status dark">Period Time</div>

    <div class="time-actions">
      <button class="btn go" (click)="start()" [disabled]="rt.timerRunning() || rt.timeoutRunning() || !!rt.gameOver()">
        Start
      </button>

      <button class="btn" (click)="resume()" [disabled]="rt.timerRunning() || rt.timeLeft()<=0 || rt.timeoutRunning()">
        Resume
      </button>

      <button class="btn stop" (click)="stop()">Stop</button>
      <button class="btn" (click)="timeout(30)" [disabled]="rt.timeoutRunning() || !rt.timerRunning()">Timeout (0:30)</button>
      <button class="btn" (click)="timeout(60)" [disabled]="rt.timeoutRunning() || !rt.timerRunning()">Timeout (1:00)</button>
      <button class="btn" (click)="reset()">Reset</button>
    </div>
  </div>

  <!-- Posesi√≥n -->
  <div class="section">
    <div class="title">POSSESSION</div>
    <div class="pos">
      <button class="btn pos-btn" [class.active]="possession() === 'home'" (click)="posLeft()">‚óÑ</button>
      <button class="btn pos-none" (click)="posNone()">
        {{ possession() === 'none' ? 'None' : (possession() === 'home' ? homeName : awayName) }}
      </button>
      <button class="btn pos-btn" [class.active]="possession() === 'away'" (click)="posRight()">‚ñ∫</button>
    </div>
  </div>

  <!-- Periodo -->
  <div class="section">
    <div class="title">PERIOD</div>
    <div class="period">
      <button class="btn minus" (click)="periodMinus()">-1</button>
      <div class="period-box"><span class="num">{{ rt.quarter() }}</span></div>
      <button class="btn plus" (click)="periodPlus()">+1</button>
    </div>
  </div>

  <!-- Equipos -->
  <div class="teams">
    <!-- HOME -->
    <div class="team">
      <div class="name">{{ homeName }}</div>
      <div class="sub">SCORE</div>

      <div class="score-row">
        <button class="btn neg" [disabled]="!homeTeamId || !canScore()" (click)="minus1(homeTeamId)">-1</button>
        <div class="score-display">{{ homeScore() }}</div>
        <button class="btn pos" [disabled]="!homeTeamId || !canScore()" (click)="add(homeTeamId,1)">+1</button>
      </div>
      <div class="score-actions">
        <button class="btn pos" [disabled]="!homeTeamId || !canScore()" (click)="add(homeTeamId,3)">+3</button>
        <button class="btn pos" [disabled]="!homeTeamId || !canScore()" (click)="add(homeTeamId,2)">+2</button>
      </div>

      <!-- FOULS HOME -->
      <div class="sub fouls-title">FOULS</div>
      <div class="fouls-row">
        <button class="btn neg" [disabled]="!homeTeamId" (click)="foul(homeTeamId,-1)">-1</button>
        <div class="fouls-display">{{ homeFouls() }}</div>
        <button class="btn pos" [disabled]="!homeTeamId" (click)="foul(homeTeamId,1)">+1</button>
      </div>
    </div>

    <!-- AWAY -->
    <div class="team">
      <div class="name">{{ awayName }}</div>
      <div class="sub">SCORE</div>

      <div class="score-row">
        <button class="btn neg" [disabled]="!awayTeamId || !canScore()" (click)="minus1(awayTeamId)">-1</button>
        <div class="score-display">{{ awayScore() }}</div>
        <button class="btn pos" [disabled]="!awayTeamId || !canScore()" (click)="add(awayTeamId,1)">+1</button>
      </div>
      <div class="score-actions">
        <button class="btn pos" [disabled]="!awayTeamId || !canScore()" (click)="add(awayTeamId,3)">+3</button>
        <button class="btn pos" [disabled]="!awayTeamId || !canScore()" (click)="add(awayTeamId,2)">+2</button>
      </div>

      <!-- FOULS AWAY -->
      <div class="sub fouls-title">FOULS</div>
      <div class="fouls-row">
        <button class="btn neg" [disabled]="!awayTeamId" (click)="foul(awayTeamId,-1)">-1</button>
        <div class="fouls-display">{{ awayFouls() }}</div>
        <button class="btn pos" [disabled]="!awayTeamId" (click)="foul(awayTeamId,1)">+1</button>
      </div>
    </div>
  </div>

  <a class="link" [routerLink]="['/score', matchId()]">Mostrar Scoreboard</a>
</div>
